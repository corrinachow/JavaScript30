# Ajax Type Ahead

This exercise makes use of the `fetch()` method to create an auto-complete dropdown.

## Live Demo

TBA

## Notes

The data used for the dropdown will be retrieved using the [`fetch()`](https://developer.mozilla.org/en-US/docs/Web/API/Fetch_API) method.  The data is returned as a [promise](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Guide/Using_promises) object to which callback functions to parse to JSON and cities info are attached.

```JavaScript
fetch(endpoint)
  .then(blob => blob.json())
  .then(data => cities.push(...data))
```

A function is defined to find matches inside the `cities` array.  Using the array `filter()` method and regular expressions, the city or state matching the input is returned.

```JavaScript
function findMatches(wordToMatch, cities) {
  return cities.filter(place => {
    const regex = new RegExp(wordToMatch, 'gi');
    return place.city.match(regex) || place.state.match(regex);
  })
}
```

A new array, `matchArray` is created using the output of the `findMatches` function.


The HTML is generated by using the `map()` method on the `matchArray`.

A `.hl` (for highlight) class is added to each city and state that match the RegExp created from the user input.  The list elements containing the city name, state, and population is created and set to `.suggestions` in the body using the [Element.innerHTML](https://developer.mozilla.org/en-US/docs/Web/API/Element/innerHTML) property

```JavaScript
function displayMatches() {
  const matchArray = findMatches(this.value, cities);
  const html = matchArray.map(place => {
    const regex = new RegExp(this.value, 'gi');
    const cityName = place.city.replace(regex, `<span class="hl">${this.value}</span>`);
    const stateName = place.state.replace(regex, `<span class="hl">${this.value}</span>`);
    return `
      <li>
        <span class="name">${cityName}, ${stateName}</span>
        <span class="population">${numberWithCommas(place.population)}</span>
      </li>
    `;
  }).join('');
  suggestions.innerHTML = html;
}
```

Finally, the **change** and **keyup** events are attached to the `displayMatches` function.

```JavaScript
const searchInput = document.querySelector('.search')
const suggestions = document.querySelector('.suggestions')

searchInput.addEventListener('change', displayMatches);
searchInput.addEventListener('keyup', displayMatches);
```

## Events

- **change**
- **keyup**


## Resources

[Spread syntax](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/Spread_syntax)
[Array.prototype.filter()](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/filter)


